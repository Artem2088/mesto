(()=>{"use strict";class e{constructor({data:e,handleCardClick:t},i){this._link=e.link,this._name=e.name,this._cardSelector=i,this._handleCardClick=t}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}_deleteClickHandler=()=>{this._element.remove()};_likeClickHandler=()=>{this._placeButtonLike.classList.toggle("element__icon_active")};_setEventListeners=()=>{this._placeButtonRemove.addEventListener("click",this._deleteClickHandler),this._placeButtonLike.addEventListener("click",this._likeClickHandler),this._elementImage.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))};generateCard=()=>(this._element=this._getTemplate(),this._elementImage=this._element.querySelector(".element__image"),this._elementTitle=this._element.querySelector(".element__title"),this._placeButtonLike=this._element.querySelector(".element__button-like"),this._placeButtonRemove=this._element.querySelector(".element__delete"),this._setEventListeners(),this._elementTitle.textContent=this._name,this._elementImage.src=this._link,this._elementImage.alt="Фотография местности "+this._name,this._element)}class t{constructor(e,t){this._config=e,this._form=t}enableValidation=()=>{this._inputsList=this._form.querySelectorAll(this._config.inputSelector),this._submitButton=this._form.querySelector(this._config.submitButtonSelector),this._setEventListeners(this._form,this._config,this._submitButton),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._disabledButton(this._submitButton,this._config)})),this._setButtonState(this._submitButton,this._form.checkValidity(),this._config)};_setEventListeners=(e,t,i)=>{this._inputsList.forEach((n=>{n.addEventListener("input",(()=>{this._checkInputValidity(e,n,t),this._setButtonState(i,e.checkValidity(),t)}))}))};_setButtonState=(e,t,i)=>{t?(e.classList.remove(i.buttonInvalidClass),e.disabled=!1):this._disabledButton(e,i)};_disabledButton=(e,t)=>{e.classList.add(t.buttonInvalidClass),e.disabled=!0};_checkInputValidity=(e,t,i)=>{t.validity.valid?this._hideError(e,t,i):this._showError(e,t,i)};_hideError=(e,t,i)=>{e.querySelector(`#${t.name}-error`).textContent="",t.classList.remove(i.inputInvalidClass)};_showError=(e,t,i)=>{e.querySelector(`#${t.name}-error`).textContent=t.validationMessage,t.classList.add(i.inputInvalidClass)}}class i{constructor(e){this._container=e,this._input1=document.querySelector("#input__error1"),this._input2=document.querySelector("#input__error2"),this._span1=document.querySelector(".span__error1"),this._span2=document.querySelector(".span__error2")}open(){this._container.classList.add("popup_opened"),this._input1.classList.remove("popup__input-error_active"),this._input2.classList.remove("popup__input-error_active"),this._span1.textContent="",this._span2.textContent=""}close(){this._container.classList.remove("popup_opened")}_handleEscClose=e=>{"Escape"===e.key&&this.close(this._container)};_handleClickContainer=e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__button-close-icon"))&&this.close(this._container)};setEventListeners(){document.addEventListener("keydown",this._handleEscClose),this._container.addEventListener("click",this.open(this._container)),this._container.addEventListener("click",this._handleClickContainer)}}class n extends i{constructor({name:e,link:t},i){super(i),this._popupElemImg=document.querySelector(".popup-image__picture"),this._popupElemCaptain=document.querySelector(".popup-image__description"),this._name=e,this._link=t}open(){this._popupElemImg.src=this._link,this._popupElemCaptain.textContent=this._name,super.open()}}class s extends i{constructor({submitForm:e,container:t}){super(t),this._submitForm=e,this._formSelector=this._container.querySelector(".popup__form")}_getInputValues(){return this._inputList=this._formSelector.querySelectorAll(".popup__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}close(){super.close(),this._formSelector.reset()}setEventListeners(){super.setEventListeners(),this._formSelector.addEventListener("submit",this._handleSubmitForm)}_handleSubmitForm=e=>{e.preventDefault(),this._submitForm(this._getInputValues()),this.close(this._container)}}const r=new class{constructor({data:e,renderer:t},i){this._renderedItems=e,this._renderer=t,this._container=i}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}setItem(e){this._container.prepend(e)}}({data:initialCards,renderer:t=>{const i=new e({data:t,handleCardClick:(e,t)=>{const i=new n({name:e,link:t},popupImageContainer);i.open(),i.setEventListeners()}},".elements-template").generateCard();r.setItem(i)}},placesListContainer),o=new s({submitForm:t=>{t.name=t["popup-input-place-name"],t.link=t["popup-input-url"],delete t["popup-input-place-name"],delete t["popup-input-url"];const i=new e({data:t,handleCardClick:(e,t)=>{const i=new n({name:e,link:t},popupImageContainer);i.open(),i.setEventListeners()}},".elements-template").generateCard();r.setItem(i)},container:popupAddCardContainer}),a=new class{constructor({titleContainer:e,subTitleContainer:t}){this._titleContainer=e,this._subTitleContainer=t}getUserInfo(){return this._profileValues={},this._profileValues.title=this._titleContainer.textContent,this._profileValues.subtitle=this._subTitleContainer.textContent,this._profileValues}setUserInfo(e){this._titleContainer.textContent=e["popup-input-name"],this._subTitleContainer.textContent=e["popup-input-status"]}}({titleContainer:profileTitleContainer,subTitleContainer:profileSubtitleContainer}),l=new s({submitForm:e=>{a.setUserInfo(e)},container:popupProfileContainer});r.renderItems(),new t(validationConfigPopup,popupFormEditContainer).enableValidation(),new t(validationConfigPopup,popupFormAddContainer).enableValidation(),profileEditButton.addEventListener("click",(()=>{popupNameField.value=a.getUserInfo().title,popupStatusField.value=a.getUserInfo().subtitle,l.open(),l.setEventListeners()})),profileAddButton.addEventListener("click",(()=>{o.open(),o.setEventListeners()}))})();